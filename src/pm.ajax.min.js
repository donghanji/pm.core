/*
   pm.build.js ,version 1.2.1 ,updated on 2016-03-07
   module for Plugins Modules library.

   https://github.com/donghanji/pm
 */

!function(){var a=module.globals("$");module.declare("pm.ajax",[a,"pm","pm.config"],function(b){function c(a,b){var c=i[a]&&i[a].action||a||"",d=/\{([\w\-\.]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,e=function(a,c){var d=b[c];return delete b[c],void 0!==d?d:""};return c=c.replace(d,e),c=c.replace(/(\/){2,}/g,"/"),c=c.replace(/\/$/,"")}var d=b(a),e=b("pm"),f=b("pm.config"),g=f.AJAX_REQUEST_HANDLE,h={url:f.LOGIC_SERVER_PATH,headers:{},timeout:12e4,type:"GET"},i=f.AJAX_RESTFUL_API||{},j={config:function(a){return d.extend(h,a),this},request:function(a,b){b=d.extend({},h,b);var e=b.error||function(a){if("string"==typeof a)try{a=d.parseJSON(a)}catch(c){console.log("error ,and data error ,no json!")}g?g(a,"",b.error):b.error&&b.error(a)},f=b.success;if(b.success=function(a){if("string"==typeof a)try{a=d.parseJSON(a)}catch(b){console.log("success,but data error ,no json!")}g?g(a,f,e):f&&f(a)},!window.navigator.onLine)return e({code:10001,info:"You are in offline status!"}),this;if(!a)throw"There is no ACTION name!";return b.url=b.url+(c(a,b.data||{})||a),b.type=i[a]&&i[a].method||b.type,b.type=b.type.toUpperCase(),d.ajax(b)}};return e.ns("pm.ajax"),e.ajax=j,j})}();